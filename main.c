#pragma config(Sensor, S2,     gyro,           sensorEV3_Gyro)
#pragma config(Motor,  motorB,          left,          tmotorEV3_Large, PIDControl, driveLeft, encoder)
#pragma config(Motor,  motorC,          right,         tmotorEV3_Large, PIDControl, driveRight, encoder)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

#define STATE_DEFAULT 0
#define STATE_OTHER   1

#include "pid.c"

int state = 0;

task sensorRead() {
	while(true) {
		//default state
		state = STATE_DEFAULT;
		//TODO test for line
	}
}

task main() {
	startTask(sensorRead);

	sensorReset(S2);
	resetGyro(S2);

	while (true) {
		switch (state) {
		case STATE_DEFAULT:
			float gyroRead = getGyroHeading(S2);
			int *speeds = drive(0, gyroRead, 90);
			setMotorSpeed(motorB, speeds[0]);
			setMotorSpeed(motorC, speeds[1]);
			break;
		case STATE_OTHER:
			break;
		default:
			writeDebugStreamLine("Entered unknown state %d, aborting...", state);
			stopAllTasks();
		}
	}
}
